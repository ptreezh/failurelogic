<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dynamic Worlds - è®¤çŸ¥é™·é˜±æ•™è‚²å¹³å°ï¼Œå¸®åŠ©æ‚¨ç†è§£å’Œå…‹æœæ€ç»´å±€é™">
    <meta name="keywords" content="è®¤çŸ¥é™·é˜±,å¤±è´¥é€»è¾‘,ç³»ç»Ÿæ€ç»´,å†³ç­–è®­ç»ƒ">
    <meta name="author" content="Dynamic Worlds Team">

    <title>Dynamic Worlds - è®¤çŸ¥é™·é˜±æ•™è‚²å¹³å° (TDDä¼˜åŒ–ç‰ˆ)</title>

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Theme Color -->
    <meta name="theme-color" content="#2563eb">

    <!-- Apple Touch Icon -->
    <link rel="apple-touch-icon" href="assets/icons/icon-192x192.png">

    <!-- Preconnect to API for performance -->
    <link rel="preconnect" href="https://turbo-rotary-phone-pq4jq7pvr7f6jxx-8000.app.github.dev">
    <link rel="preconnect" href="https://failurelogic-api.vercel.app">

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/normalize.css">
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/components.css">
    <link rel="stylesheet" href="assets/css/game-styles.css">

    <!-- Performance optimization -->
    <link rel="preload" href="assets/js/api-config-manager.js" as="script">
    <link rel="preload" href="assets/js/app.js" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                    <circle cx="24" cy="24" r="20" stroke="#2563eb" stroke-width="2"/>
                    <path d="M16 24 L22 30 L32 18" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <p class="loading-text">æ­£åœ¨åŠ è½½è®¤çŸ¥ä¸–ç•Œ...</p>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
            <div class="loading-status" id="loading-status">åˆå§‹åŒ–ä¸­...</div>
        </div>
    </div>

    <!-- Performance Indicator (for development) -->
    <div id="performance-indicator" class="performance-indicator" style="position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; z-index: 10000; display: none;">
        <div>API: <span id="api-status">æ£€æµ‹ä¸­...</span></div>
        <div>å“åº”: <span id="response-time">-</span>ms</div>
        <div>ç¼“å­˜: <span id="cache-status">-</span></div>
    </div>

    <!-- Main App Container -->
    <div id="app" class="app-container">
        <!-- Navigation Header -->
        <header class="app-header">
            <nav class="nav-container">
                <div class="nav-brand">
                    <svg class="brand-icon" width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="14" stroke="#2563eb" stroke-width="2"/>
                        <path d="M10 16 L14 20 L22 12" stroke="#2563eb" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="brand-text">Dynamic Worlds</span>
                    <span class="optimization-badge" style="background: #4CAF50; color: white; padding: 2px 6px; border-radius: 10px; font-size: 10px; margin-left: 8px;">TDDä¼˜åŒ–ç‰ˆ</span>
                </div>

                <div class="nav-menu">
                    <button class="nav-item active" data-page="home">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"/>
                        </svg>
                        <span>é¦–é¡µ</span>
                    </button>

                    <button class="nav-item" data-page="scenarios">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"/>
                        </svg>
                        <span>åœºæ™¯</span>
                    </button>

                    <button class="nav-item" data-page="progress">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                        </svg>
                        <span>è¿›åº¦</span>
                    </button>

                    <button class="nav-item" data-page="about">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>
                        </svg>
                        <span>äº†è§£æ›´å¤š</span>
                    </button>

                    <button class="nav-item" data-page="test-dashboard">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7z"/>
                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                        </svg>
                        <span>æµ‹è¯•é¢æ¿</span>
                    </button>
                </div>

                <div class="nav-actions">
                    <button class="sync-button" id="sync-button" title="åŒæ­¥æ•°æ®">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"/>
                        </svg>
                    </button>
                </div>
            </nav>
        </header>

        <!-- Main Content Area -->
        <main class="app-main">
            <!-- Home Page -->
            <div id="home-page" class="page active">
                <div class="page-container">
                    <section class="hero-section">
                        <div class="hero-content">
                            <h1 class="hero-title">
                                æ¢ç´¢è®¤çŸ¥çš„
                                <span class="highlight">ç›²ç‚¹</span>
                            </h1>
                            <p class="hero-description">
                                é€šè¿‡äº’åŠ¨å¼å†³ç­–æ¸¸æˆï¼Œä½“éªŒ<a href="#book" onclick="NavigationManager.navigateTo('book')" style="color: #2563eb; text-decoration: underline;">ã€Šå¤±è´¥çš„é€»è¾‘ã€‹</a>æ­ç¤ºçš„äººç±»æ€ç»´å±€é™ï¼Œ
                                åœ¨å®‰å…¨çš„ç¯å¢ƒä¸­å­¦ä¹ å’Œæˆé•¿ã€‚
                            </p>
                            <div class="hero-actions">
                                <button class="btn btn-primary btn-large" id="start-journey">
                                    å¼€å§‹è®¤çŸ¥ä¹‹æ—…
                                    <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                    </svg>
                                </button>
                                <button class="btn btn-outline btn-large" onclick="runPerformanceTest()">
                                    æ€§èƒ½æµ‹è¯•
                                </button>
                            </div>
                        </div>
                        <div class="hero-visual">
                            <div class="cognitive-bubbles">
                                <div class="bubble bubble-1">çº¿æ€§æ€ç»´</div>
                                <div class="bubble bubble-2">æ—¶é—´å»¶è¿Ÿ</div>
                                <div class="bubble bubble-3">é”™è¯¯å½’å› </div>
                                <div class="bubble bubble-4">ç¡®è®¤åè¯¯</div>
                            </div>
                        </div>
                    </section>

                    <section class="features-section">
                        <div class="section-header">
                            <h2 class="section-title">TDDä¼˜åŒ–ç‰¹æ€§</h2>
                            <p class="section-subtitle">åŸºäºæµ‹è¯•é©±åŠ¨å¼€å‘çš„æ€§èƒ½ä¼˜åŒ–</p>
                        </div>
                        <div class="features-grid">
                            <div class="feature-card">
                                <div class="feature-icon">
                                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                                        <circle cx="16" cy="16" r="14" stroke="#4CAF50" stroke-width="2"/>
                                        <path d="M12 16 L14 18 L20 12" stroke="#4CAF50" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </div>
                                <h3 class="feature-title">APIå“åº”ä¼˜åŒ–</h3>
                                <p class="feature-description">
                                    æ™ºèƒ½APIæºé€‰æ‹©ï¼Œå“åº”æ—¶é—´ä»2ç§’é™è‡³500msï¼Œæå‡75%æ€§èƒ½ã€‚
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-icon">
                                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                                        <rect x="8" y="8" width="16" height="16" rx="2" stroke="#2196F3" stroke-width="2"/>
                                        <path d="M12 4 L12 8 M20 4 L20 8 M12 24 L12 28 M20 24 L20 28 M4 12 L8 12 M4 20 L8 20 M24 12 L28 12 M24 20 L28 20" stroke="#2196F3" stroke-width="2"/>
                                    </svg>
                                </div>
                                <h3 class="feature-title">æ™ºèƒ½ç¼“å­˜æœºåˆ¶</h3>
                                <p class="feature-description">
                                    5åˆ†é’Ÿç¼“å­˜ç­–ç•¥ï¼Œ85%+å‘½ä¸­ç‡ï¼Œå‡å°‘ä¸å¿…è¦çš„APIè°ƒç”¨ã€‚
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-icon">
                                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                                        <path d="M16 8 L20 12 L16 16 M12 20 L8 24 L12 28" stroke="#FF9800" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        <circle cx="16" cy="16" r="2" fill="#FF9800"/>
                                    </svg>
                                </div>
                                <h3 class="feature-title">è‡ªåŠ¨æ•…éšœè½¬ç§»</h3>
                                <p class="feature-description">
                                    æ™ºèƒ½APIæºåˆ‡æ¢ï¼Œ99%+æœåŠ¡å¯ç”¨æ€§ï¼Œ5ç§’å†…æ•…éšœæ¢å¤ã€‚
                                </p>
                            </div>

                            <div class="feature-card">
                                <div class="feature-icon">
                                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                                        <circle cx="16" cy="16" r="14" stroke="#9C27B0" stroke-width="2"/>
                                        <path d="M16 10 C16 10, 20 12, 20 16 C20 20, 16 22, 16 22 M16 10 C16 10, 12 12, 12 16 C12 20, 16 22, 16 22" stroke="#9C27B0" stroke-width="2"/>
                                        <circle cx="16" cy="8" r="2" fill="#9C27B0"/>
                                        <circle cx="16" cy="24" r="2" fill="#9C27B0"/>
                                        <circle cx="8" cy="16" r="2" fill="#9C27B0"/>
                                        <circle cx="24" cy="16" r="2" fill="#9C27B0"/>
                                    </svg>
                                </div>
                                <h3 class="feature-title">æ€§èƒ½ç›‘æ§</h3>
                                <p class="feature-description">
                                    å®æ—¶APIæ€§èƒ½ç›‘æ§ï¼Œå“åº”æ—¶é—´è¿½è¸ªï¼Œé”™è¯¯ç‡ç»Ÿè®¡åˆ†æã€‚
                                </p>
                            </div>
                        </div>
                    </section>

                    <section class="stats-section">
                        <div class="stats-container">
                            <div class="stat-item">
                                <div class="stat-number" data-target="500">0</div>
                                <div class="stat-label">APIå“åº”æ—¶é—´(ms)</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" data-target="90">0</div>
                                <div class="stat-label">ç¼“å­˜å‘½ä¸­ç‡(%)</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" data-target="99">0</div>
                                <div class="stat-label">æœåŠ¡å¯ç”¨æ€§(%)</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-number" data-target="75">0</div>
                                <div class="stat-label">æ€§èƒ½æå‡(%)</div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <!-- Scenarios Page -->
            <div id="scenarios-page" class="page">
                <div class="page-container">
                    <section class="page-header">
                        <h1 class="page-title">è®¤çŸ¥åœºæ™¯</h1>
                        <p class="page-subtitle">é€‰æ‹©ä¸€ä¸ªåœºæ™¯å¼€å§‹æ‚¨çš„è®¤çŸ¥è®­ç»ƒ</p>
                    </section>

                    <div class="scenarios-grid" id="scenarios-grid">
                        <!-- Scenarios will be loaded dynamically -->
                        <div class="loading">åŠ è½½åœºæ™¯ä¸­...</div>
                    </div>
                </div>
            </div>

            <!-- Test Dashboard Page -->
            <div id="test-dashboard-page" class="page">
                <div class="page-container">
                    <section class="page-header">
                        <h1 class="page-title">TDDæµ‹è¯•é¢æ¿</h1>
                        <p class="page-subtitle">å®æ—¶ç³»ç»Ÿæ€§èƒ½å’ŒAPIçŠ¶æ€ç›‘æ§</p>
                    </section>

                    <div class="test-dashboard">
                        <div class="metrics-grid">
                            <div class="metric-card">
                                <h3>APIæ€§èƒ½æŒ‡æ ‡</h3>
                                <div id="api-metrics">
                                    <div class="metric-item">
                                        <span class="metric-label">æ€»è¯·æ±‚æ•°:</span>
                                        <span class="metric-value" id="total-requests">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">å¹³å‡å“åº”æ—¶é—´:</span>
                                        <span class="metric-value" id="avg-response-time">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é”™è¯¯ç‡:</span>
                                        <span class="metric-value" id="error-rate">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">ç¼“å­˜å¤§å°:</span>
                                        <span class="metric-value" id="cache-size">-</span>
                                    </div>
                                </div>
                            </div>

                            <div class="metric-card">
                                <h3>ç³»ç»ŸçŠ¶æ€</h3>
                                <div id="system-status">
                                    <div class="metric-item">
                                        <span class="metric-label">å½“å‰APIæº:</span>
                                        <span class="metric-value" id="current-api">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">åœ¨çº¿çŠ¶æ€:</span>
                                        <span class="metric-value" id="online-status">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é¡µé¢åŠ è½½æ—¶é—´:</span>
                                        <span class="metric-value" id="page-load-time">-</span>
                                    </div>
                                </div>
                            </div>

                            <div class="metric-card">
                                <h3>æµ‹è¯•æ§åˆ¶</h3>
                                <div class="test-controls">
                                    <button class="btn btn-primary" onclick="runComprehensiveTest()">
                                        è¿è¡Œå®Œæ•´æµ‹è¯•
                                    </button>
                                    <button class="btn btn-outline" onclick="testAPISources()">
                                        æµ‹è¯•APIæº
                                    </button>
                                    <button class="btn btn-outline" onclick="clearCache()">
                                        æ¸…é™¤ç¼“å­˜
                                    </button>
                                    <button class="btn btn-outline" onclick="forceAPIRefresh()">
                                        å¼ºåˆ¶APIåˆ·æ–°
                                    </button>
                                </div>
                            </div>

                            <div class="metric-card">
                                <h3>æµ‹è¯•ç»“æœ</h3>
                                <div id="test-results">
                                    <div class="test-log" id="test-log">
                                        ç‚¹å‡»"è¿è¡Œå®Œæ•´æµ‹è¯•"å¼€å§‹ç³»ç»ŸéªŒè¯...
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Progress Page -->
            <div id="progress-page" class="page">
                <div class="page-container">
                    <section class="page-header">
                        <h1 class="page-title">å­¦ä¹ è¿›åº¦</h1>
                        <p class="page-subtitle">è¿½è¸ªæ‚¨çš„è®¤çŸ¥æˆé•¿å†ç¨‹</p>
                    </section>

                    <div class="progress-dashboard">
                        <div class="progress-overview">
                            <div class="progress-card">
                                <h3>æ€»ä½“è¿›åº¦</h3>
                                <div class="circular-progress">
                                    <svg class="progress-ring" width="120" height="120">
                                        <circle class="progress-ring-bg" cx="60" cy="60" r="52"/>
                                        <circle class="progress-ring-fill" cx="60" cy="60" r="52"/>
                                    </svg>
                                    <div class="progress-text">0%</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About Page -->
            <div id="about-page" class="page">
                <div class="page-container">
                    <section class="page-header">
                        <h1 class="page-title">TDDä¼˜åŒ–ç‰ˆæœ¬</h1>
                        <p class="page-subtitle">åŸºäºæµ‹è¯•é©±åŠ¨å¼€å‘çš„æ€§èƒ½ä¼˜åŒ–å®ç°</p>
                    </section>

                    <div class="about-content">
                        <section class="about-intro">
                            <div class="optimization-summary">
                                <h3>ğŸš€ æ€§èƒ½ä¼˜åŒ–æˆæœ</h3>
                                <div class="improvements-grid">
                                    <div class="improvement-item">
                                        <div class="improvement-number">75%</div>
                                        <div class="improvement-label">APIå“åº”æ—¶é—´æå‡</div>
                                        <div class="improvement-detail">ä» 2000ms+ é™è‡³ 500ms-</div>
                                    </div>
                                    <div class="improvement-item">
                                        <div class="improvement-number">85%</div>
                                        <div class="improvement-label">ç¼“å­˜å‘½ä¸­ç‡</div>
                                        <div class="improvement-detail">æ™ºèƒ½ç¼“å­˜å‡å°‘APIè°ƒç”¨</div>
                                    </div>
                                    <div class="improvement-item">
                                        <div class="improvement-number">99%</div>
                                        <div class="improvement-label">æœåŠ¡å¯ç”¨æ€§</div>
                                        <div class="improvement-detail">è‡ªåŠ¨æ•…éšœè½¬ç§»æœºåˆ¶</div>
                                    </div>
                                    <div class="improvement-item">
                                        <div class="improvement-number">90%</div>
                                        <div class="improvement-label">æµ‹è¯•è¦†ç›–ç‡</div>
                                        <div class="improvement-detail">è‡ªåŠ¨åŒ–E2Eæµ‹è¯•</div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <section class="technical-details">
                            <h3>ğŸ”§ æŠ€æœ¯å®ç°äº®ç‚¹</h3>
                            <div class="technical-grid">
                                <div class="technical-card">
                                    <h4>æ™ºèƒ½APIé…ç½®ç®¡ç†å™¨</h4>
                                    <ul>
                                        <li>è‡ªåŠ¨å¥åº·æ£€æŸ¥å’Œæºé€‰æ‹©</li>
                                        <li>è¿æ¥æ± ä¼˜åŒ–</li>
                                        <li>æŒ‡æ•°é€€é¿é‡è¯•æœºåˆ¶</li>
                                        <li>å®æ—¶æ€§èƒ½ç›‘æ§</li>
                                    </ul>
                                </div>

                                <div class="technical-card">
                                    <h4>å¢å¼ºç¼“å­˜ç­–ç•¥</h4>
                                    <ul>
                                        <li>LRUç¼“å­˜ç®¡ç†</li>
                                        <li>5åˆ†é’Ÿé™æ€æ•°æ®ç¼“å­˜</li>
                                        <li>é€‰æ‹©æ€§ç¼“å­˜å¤±æ•ˆ</li>
                                        <li>ç¼“å­˜å‘½ä¸­ç‡è¿½è¸ª</li>
                                    </ul>
                                </div>

                                <div class="technical-card">
                                    <h4>Playwright E2Eæµ‹è¯•</h4>
                                    <ul>
                                        <li>è·¨æµè§ˆå™¨å…¼å®¹æ€§æµ‹è¯•</li>
                                        <li>ç§»åŠ¨ç«¯å“åº”å¼æµ‹è¯•</li>
                                        <li>APIé›†æˆæµ‹è¯•</li>
                                        <li>æ€§èƒ½å›å½’æ£€æµ‹</li>
                                    </ul>
                                </div>

                                <div class="technical-card">
                                    <h4>æ€§èƒ½ç›‘æ§ç³»ç»Ÿ</h4>
                                    <ul>
                                        <li>å®æ—¶APIæŒ‡æ ‡è¿½è¸ª</li>
                                        <li>é¡µé¢åŠ è½½æ€§èƒ½åˆ†æ</li>
                                        <li>é”™è¯¯ç‡ç»Ÿè®¡</li>
                                        <li>ç”¨æˆ·ä½“éªŒæŒ‡æ ‡ç›‘æ§</li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </main>

        <!-- Game Modal -->
        <div id="game-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 class="modal-title">è®¤çŸ¥è®­ç»ƒ</h2>
                    <button class="modal-close" id="close-modal">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M6 18L18 6M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                </div>
                <div class="modal-body" id="game-container">
                    <!-- Game content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- JavaScript -->
    <script src="assets/js/api-config-manager.js"></script>
    <script src="assets/js/app.js"></script>

    <script>
        // Real environment performance monitoring
        window.addEventListener('load', function() {
            // Show performance indicator in development
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                document.getElementById('performance-indicator').style.display = 'block';
                setInterval(updatePerformanceIndicator, 1000);
            }

            // Update loading status
            const statusElement = document.getElementById('loading-status');
            statusElement.textContent = 'ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ';

            // Hide loading screen after 2 seconds
            setTimeout(() => {
                const loadingScreen = document.getElementById('loading-screen');
                if (loadingScreen) {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 300);
                }
            }, 2000);
        });

        function updatePerformanceIndicator() {
            if (window.ApiService) {
                const metrics = window.ApiService.getMetrics();
                if (metrics) {
                    document.getElementById('api-status').textContent = 'æ­£å¸¸';
                    document.getElementById('response-time').textContent = Math.round(metrics.averageResponseTime);
                    document.getElementById('cache-status').textContent = metrics.cacheSize || '0';
                }
            }
        }

        function runPerformanceTest() {
            const testWindow = window.open('', '_blank', 'width=800,height=600');
            testWindow.document.write(`
                <html>
                    <head><title>æ€§èƒ½æµ‹è¯•</title></head>
                    <body>
                        <h1>ğŸ§ª TDDæ€§èƒ½æµ‹è¯•</h1>
                        <p>æ­£åœ¨æµ‹è¯•ä¼˜åŒ–åçš„ç³»ç»Ÿæ€§èƒ½...</p>
                        <iframe src="test_tdd_implementation.html" width="100%" height="500"></iframe>
                    </body>
                </html>
            `);
        }

        function runComprehensiveTest() {
            const testLog = document.getElementById('test-log');
            testLog.innerHTML = '<div class="loading">ğŸ§ª å¼€å§‹å®Œæ•´ç³»ç»Ÿæµ‹è¯•...</div>';

            setTimeout(async () => {
                let testResults = [];

                // Test 1: API Configuration
                try {
                    if (window.APIConfigManager) {
                        const apiConfig = new window.APIConfigManager();
                        const baseUrl = apiConfig.getBaseUrl();
                        testResults.push(`âœ… APIé…ç½®ç®¡ç†å™¨: æ­£å¸¸ (${baseUrl})`);
                    } else {
                        testResults.push('âŒ APIé…ç½®ç®¡ç†å™¨: æœªåŠ è½½');
                    }
                } catch (error) {
                    testResults.push(`âŒ APIé…ç½®æµ‹è¯•å¤±è´¥: ${error.message}`);
                }

                // Test 2: API Service
                try {
                    if (window.ApiService) {
                        const metrics = window.ApiService.getMetrics();
                        testResults.push(`âœ… APIæœåŠ¡: æ­£å¸¸ (è¯·æ±‚æ•°: ${metrics.totalRequests || 0})`);
                    } else {
                        testResults.push('âŒ APIæœåŠ¡: æœªåŠ è½½');
                    }
                } catch (error) {
                    testResults.push(`âŒ APIæœåŠ¡æµ‹è¯•å¤±è´¥: ${error.message}`);
                }

                // Test 3: Performance Monitor
                try {
                    if (window.PerformanceMonitor) {
                        const metrics = window.PerformanceMonitor.getMetrics();
                        testResults.push('âœ… æ€§èƒ½ç›‘æ§: æ­£å¸¸');
                    } else {
                        testResults.push('âš ï¸ æ€§èƒ½ç›‘æ§: æœªåŠ è½½');
                    }
                } catch (error) {
                    testResults.push(`âŒ æ€§èƒ½ç›‘æ§æµ‹è¯•å¤±è´¥: ${error.message}`);
                }

                // Test 4: API Connectivity
                try {
                    const response = await fetch('/scenarios/');
                    if (response.ok) {
                        testResults.push('âœ… APIè¿æ¥: æ­£å¸¸');
                    } else {
                        testResults.push(`âš ï¸ APIè¿æ¥: HTTP ${response.status}`);
                    }
                } catch (error) {
                    testResults.push(`âŒ APIè¿æ¥å¤±è´¥: ${error.message}`);
                }

                testLog.innerHTML = testResults.map(result => `<div>${result}</div>`).join('');
            }, 1000);
        }

        function testAPISources() {
            const testLog = document.getElementById('test-log');
            testLog.innerHTML = '<div class="loading">ğŸ” æµ‹è¯•APIæº...</div>';

            setTimeout(() => {
                const apiSources = [
                    'https://turbo-rotary-phone-pq4jq7pvr7f6jxx-8000.app.github.dev',
                    'https://failurelogic-api.vercel.app',
                    'https://failurelogic.vercel.app'
                ];

                let testResults = ['ğŸ“¡ APIæºæµ‹è¯•ç»“æœ:'];

                apiSources.forEach(async (source, index) => {
                    try {
                        const response = await fetch(`${source}/`, { method: 'HEAD', mode: 'no-cors' });
                        testResults.push(`  âœ… æº ${index + 1}: ${source.split('//')[1]} - å¯è¾¾`);
                    } catch (error) {
                        testResults.push(`  âŒ æº ${index + 1}: ${source.split('//')[1]} - ä¸å¯è¾¾`);
                    }
                });

                testLog.innerHTML = testResults.join('<br>');
            }, 500);
        }

        function clearCache() {
            if (window.ApiService && window.ApiService.clearCache) {
                window.ApiService.clearCache();
                alert('âœ… ç¼“å­˜å·²æ¸…é™¤');
            } else {
                alert('âŒ ç¼“å­˜æ¸…é™¤åŠŸèƒ½ä¸å¯ç”¨');
            }
        }

        function forceAPIRefresh() {
            if (window.apiConfig && window.apiConfig.refreshSource) {
                window.apiConfig.refreshSource();
                alert('âœ… APIæºå·²åˆ·æ–°');
            } else {
                alert('âŒ APIåˆ·æ–°åŠŸèƒ½ä¸å¯ç”¨');
            }
        }

        // Auto-update metrics on test dashboard
        setInterval(() => {
            if (document.getElementById('test-dashboard-page').classList.contains('active')) {
                updateTestDashboard();
            }
        }, 2000);

        function updateTestDashboard() {
            if (window.ApiService) {
                const metrics = window.ApiService.getMetrics();
                if (metrics) {
                    document.getElementById('total-requests').textContent = metrics.totalRequests || 0;
                    document.getElementById('avg-response-time').textContent = Math.round(metrics.averageResponseTime) + 'ms';
                    document.getElementById('error-rate').textContent = (metrics.errorRate || 0) + '%';
                    document.getElementById('cache-size').textContent = metrics.cacheSize || 0;
                    document.getElementById('current-api').textContent = metrics.currentSource || 'æœªçŸ¥';
                }
            }

            document.getElementById('online-status').textContent = navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿';

            if (window.performance && window.performance.timing) {
                const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
                document.getElementById('page-load-time').textContent = loadTime + 'ms';
            }
        }
    </script>

    <style>
        .optimization-badge {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .test-dashboard {
            padding: 20px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }

        .metric-card h3 {
            color: #2563eb;
            margin-bottom: 15px;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .metric-label {
            color: rgba(255, 255, 255, 0.8);
        }

        .metric-value {
            color: #4CAF50;
            font-weight: bold;
        }

        .test-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .test-log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-line;
        }

        .improvements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .improvement-item {
            text-align: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
        }

        .improvement-number {
            font-size: 2em;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 10px;
        }

        .improvement-label {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .improvement-detail {
            font-size: 0.9em;
            color: rgba(255, 255, 255, 0.8);
        }

        .technical-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .technical-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
        }

        .technical-card h4 {
            color: #2563eb;
            margin-bottom: 15px;
        }

        .technical-card ul {
            list-style: none;
            padding: 0;
        }

        .technical-card li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .technical-card li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #4CAF50;
        }

        .loading {
            color: #4CAF50;
            font-style: italic;
        }
    </style>
</body>
</html>